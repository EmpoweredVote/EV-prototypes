# Main build configuration
[build]
  # Publish the root directory which contains index.html and subdirectories
  publish = "."

  command = "npm run build:all"

# API proxy (must come before SPA redirects)
[[redirects]]
  from = "/api/*"
  to = "https://ev-backend-h3n8.onrender.com/:splat"
  status = 200
  force = true

# Redirect rules for each project to handle SPA routing
[[redirects]]
  from = "/read-rank/*"
  to = "/read-rank/dist/index.html"
  status = 200

[[redirects]]
  from = "/treasury-tracker/*"
  to = "/treasury-tracker/dist/index.html"
  status = 200

[[redirects]]
  from = "/empowered-badges/*"
  to = "/empowered-badges/dist/index.html"
  status = 200

[[redirects]]
  from = "/data-entry/*"
  to = "/data-entry/dist/index.html"
  status = 200

[[redirects]]
  from = "/fallacy-finders/*"
  to = "/fallacy-finders/dist/index.html"
  status = 200

# Set correct MIME types for JavaScript files
[[headers]]
  for = "/**/*.js"
  [headers.values]
    Content-Type = "application/javascript; charset=utf-8"
